# ğŸ­ Scapin â€” Votre Gardien Cognitif Personnel

**Version** : 1.0.0-alpha  
**Statut** : ğŸ—ï¸ DÃ©veloppement actif â€” Architecture cognitive complÃ¨te  
**Python** : 3.9+

> NommÃ© d'aprÃ¨s Scapin, le valet rusÃ© et inventif de MoliÃ¨re qui trouve toujours une solution.

---

## ğŸ¯ Vision

### La Mission

> **"Prendre soin de vous mieux que vous-mÃªme."**

Scapin n'est pas un simple processeur d'emails ou un gestionnaire de tÃ¢ches. C'est un **gardien cognitif proactif** â€” une extension active de votre esprit qui anticipe vos besoins, prÃ©pare le terrain, et pense le plus loin possible pour vous.

### Ce que Scapin Fait

- **PerÃ§oit** les Ã©vÃ©nements entrants (emails, fichiers, questions, calendrier)
- **Raisonne** avec conscience du contexte et rÃ©flexion multi-Ã©tapes itÃ©rative
- **DÃ©cide** intelligemment via des passes cognitives jusqu'Ã  95% de confiance
- **Apprend** continuellement de vos corrections et des rÃ©sultats
- **Agit** comme votre valet numÃ©rique de confiance â€” anticipant, prÃ©parant, facilitant

### La Tension Centrale RÃ©solue

> **Paradoxe** : Besoin de dÃ©lÃ©guer massivement (trop de choses Ã  gÃ©rer) ET de prÃ©server la capacitÃ© Ã  penser (dÃ©bat, challenge, exploration).

**RÃ©solution** : Scapin est simultanÃ©ment :
- **DÃ©chargeur cognitif** â€” Pour les micro-tÃ¢ches et le contexte factuel
- **Sparring partner intellectuel** â€” Pour le dÃ©bat, l'exploration, le challenge des idÃ©es

Ces deux rÃ´les libÃ¨rent de la bande passante cognitive pour se concentrer sur l'essentiel.

---

## ğŸ“š Philosophie Fondatrice

La conception de Scapin s'appuie sur des fondements thÃ©oriques solides :

| Concept | Source | Application |
|---------|--------|-------------|
| **Extended Mind** | Clark & Chalmers (1998) | Scapin est une extension de votre cognition, pas un outil externe |
| **MÃ©moire Transactive** | Wegner (1985) | Vous + Scapin formez un systÃ¨me de mÃ©moire partagÃ©e |
| **Pharmacologie** | Stiegler | Scapin augmente vos capacitÃ©s au lieu de les remplacer |
| **Effet Google** | Sparrow et al. (2011) | Scapin gÃ¨re la localisation, vous gardez l'essentiel |

### Les 5 Principes Directeurs

| # | Principe | Description |
|---|----------|-------------|
| **1** | **QualitÃ© sur vitesse** | 10-20 secondes de raisonnement pour la BONNE dÃ©cision |
| **2** | **ProactivitÃ© maximale** | Anticiper, suggÃ©rer, challenger, rappeler â€” sans attendre |
| **3** | **IntimitÃ© totale** | Aucune limite d'accÃ¨s pour une efficacitÃ© maximale |
| **4** | **Apprentissage progressif** | Seuils de confiance appris, pas de rÃ¨gles rigides |
| **5** | **Construction propre** | Lent mais bien construit dÃ¨s le dÃ©but |

ğŸ“– **Document fondateur** : [DESIGN_PHILOSOPHY.md](docs/DESIGN_PHILOSOPHY.md) â€” Capture l'Ã¢me de Scapin, les fondements thÃ©oriques complets, et les dÃ©cisions de conception.

---

## ğŸ”„ La Boucle d'AmÃ©lioration Continue

Le systÃ¨me s'amÃ©liore via un cycle vertueux centrÃ© sur le journaling quotidien :

```
JournÃ©e vÃ©cue
     â†“
Scapin prÃ©-remplit le journal (ce qu'il sait)
     â†“
Vous complÃ©tez et corrigez (~15 min)
     â†“
Enrichissement des fiches (personnes, projets, dÃ©cisions)
     â†“
Meilleure analyse future
     â†“
Suggestions plus pertinentes
     â†“
Feedback via journaling suivant
     â†“
AmÃ©lioration du systÃ¨me â†’ RÃ©pÃ©ter
```

**Information en 3 Couches** :
| Niveau | Contenu | Temps | Usage |
|--------|---------|-------|-------|
| **1** | RÃ©sumÃ© actionnable | 30s | DÃ©cision rapide |
| **2** | Contexte et options | 2 min | Choix informÃ© |
| **3** | DÃ©tails complets | Variable | Auto-alimentation Scapin |

---

## âœ¨ CapacitÃ©s Actuelles

### Production Ready (v1.0.0-alpha)

| FonctionnalitÃ© | Statut | Description |
|----------------|--------|-------------|
| **Traitement Email Intelligent** | âœ… | Classification IA, multi-comptes, traitement par lots |
| **Menu Interactif** | âœ… | Navigation clavier, sÃ©lection comptes, gestion file de rÃ©vision |
| **Multi-Comptes Email** | âœ… | Gestion illimitÃ©e de comptes avec configs sÃ©parÃ©es |
| **File de RÃ©vision** | âœ… | Approuver/modifier/rejeter les dÃ©cisions IA |
| **IntÃ©gration TÃ¢ches** | âœ… | CrÃ©ation auto OmniFocus via MCP |
| **SystÃ¨me d'Ã‰vÃ©nements** | âœ… | Pub/sub thread-safe avec 17 types d'Ã©vÃ©nements |
| **Monitoring SantÃ©** | âœ… | Checks IMAP, API IA, disque, file |
| **RÃ©cupÃ©ration Erreurs** | âœ… | Backoff exponentiel, protection timeout, cache LRU |
| **Suivi DÃ©cisions** | âœ… | Stockage SQLite avec contexte |
| **Architecture Cognitive** | âœ… | Modules valets complets (Phase 0.5) |

**QualitÃ©** : 967 tests, 95% couverture, 100% pass rate
**Code** : Score 10/10 (0 ruff warnings)

### Architecture Cognitive (Phase 0.5 â€” âœ… ComplÃ¨te)

Scapin utilise une **boucle cognitive itÃ©rative** â€” pas une IA one-shot, mais un raisonnement multi-Ã©tapes vÃ©ritable :

```
Ã‰vÃ©nement â†’ Trivelin â†’ Sancho â†” Passepartout â†’ Planchet â†’ Figaro â†’ Sganarelle
                         â†‘                                             â†“
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Boucle d'Apprentissage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Raisonnement Multi-Passes de Sancho** (jusqu'Ã  5 itÃ©rations) :

| Passe | Processus | Confiance Cible | Temps |
|-------|-----------|-----------------|-------|
| **1. Analyse Initiale** | Comprendre l'Ã©vÃ©nement | ~60-70% | 2-3s |
| **2. Enrichissement Contexte** | Interroger Passepartout | ~75-85% | 3-5s |
| **3. Raisonnement Profond** | InfÃ©rence multi-Ã©tapes, chaÃ®nes "si X alors Y" | ~85-92% | 2-4s |
| **4. Validation** | Consensus multi-provider (Claude + GPT-4o) | ~90-96% | 3-5s |
| **5. Clarification Utilisateur** | Demander quand incertain | ~95-99% | async |

**ArrÃªt** : Confiance â‰¥ 95% OU maximum d'itÃ©rations atteint

**Exemple concret** : Email du comptable avec tableur
- Passe 1 : "Email de Marie avec piÃ¨ce jointe" (65%)
- Passe 2 : Passepartout trouve "Marie = Comptable, projet Budget Q2" (82%)
- Passe 3 : InfÃ¨re deadline des notes, planifie actions (89%)
- Passe 4 : GPT-4o valide, suggÃ¨re emplacement fichier (94.5%)
- Passe 5 : Demande "Marquer prioritaire ?" â†’ "Non" (97%)
- RÃ©sultat : 5 actions exÃ©cutÃ©es parfaitement

---

## ğŸª L'Ã‰quipe des Valets

Scapin orchestre une Ã©quipe de modules spÃ©cialisÃ©s, chacun inspirÃ© d'un valet littÃ©raire cÃ©lÃ¨bre :

| Valet | Origine LittÃ©raire | Module | SpÃ©cialitÃ© |
|-------|-------------------|--------|------------|
| **Trivelin** | Marivaux, *L'Ãle des esclaves* | `src/trivelin/` | ğŸ” **Triage** â€” RÃ©ception et classification des Ã©vÃ©nements |
| **Sancho** | Cervantes, *Don Quichotte* | `src/sancho/` | ğŸ§  **Sagesse** â€” Raisonnement itÃ©ratif multi-passes |
| **Passepartout** | Verne, *Le Tour du monde* | `src/passepartout/` | ğŸ§­ **Navigation** â€” Recherche dans la base de connaissances |
| **Planchet** | Dumas, *Les Trois Mousquetaires* | `src/planchet/` | ğŸ“… **Planification** â€” Conception des plans d'action |
| **Figaro** | Beaumarchais, *Le Barbier de SÃ©ville* | `src/figaro/` | ğŸ¼ **Orchestration** â€” ExÃ©cution coordonnÃ©e des actions |
| **Sganarelle** | MoliÃ¨re | `src/sganarelle/` | ğŸ“š **Apprentissage** â€” AmÃ©lioration par l'expÃ©rience |
| **Jeeves** | Wodehouse | `src/jeeves/` | ğŸ© **Service** â€” Interface API Ã©lÃ©gante |

### Workflow Collaboratif

```
1. TRIVELIN reÃ§oit et trie l'Ã©vÃ©nement
        â†“
2. SANCHO raisonne (jusqu'Ã  5 passes)
        â†“ â† consulte â†’ PASSEPARTOUT (base de connaissances)
        â†“
3. PLANCHET conÃ§oit un plan d'action
        â†“
4. FIGARO orchestre l'exÃ©cution
        â†“
5. SGANARELLE apprend du rÃ©sultat â†’ enrichit PASSEPARTOUT
        â†‘
6. JEEVES fournit l'API pour web/mobile
```

**Structure du Projet** :
```
scapin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ trivelin/        # Perception & triage
â”‚   â”œâ”€â”€ sancho/          # Moteur de raisonnement
â”‚   â”œâ”€â”€ passepartout/    # Base de connaissances (Markdown + Git + FAISS)
â”‚   â”œâ”€â”€ planchet/        # Moteur de planification
â”‚   â”œâ”€â”€ figaro/          # Orchestration des actions (DAG)
â”‚   â”œâ”€â”€ sganarelle/      # Apprentissage & feedback
â”‚   â”œâ”€â”€ jeeves/          # Couche API (FastAPI + WebSockets)
â”‚   â””â”€â”€ core/            # Infrastructure partagÃ©e
â”œâ”€â”€ tests/               # 967 tests, 95% couverture
â””â”€â”€ docs/                # Documentation complÃ¨te
```

---

## ğŸš€ DÃ©marrage Rapide

### PrÃ©requis

- Python 3.9+
- Git
- Compte email (iCloud, Gmail, etc.)
- ClÃ© API Anthropic (Claude)

### Installation

```bash
# Cloner le dÃ©pÃ´t
git clone https://github.com/johanlb/scapin.git
cd scapin

# CrÃ©er l'environnement virtuel
python3 -m venv .venv
source .venv/bin/activate

# Installer les dÃ©pendances
pip install --upgrade pip
pip install -r requirements.txt

# Configurer
cp .env.example .env
# Ã‰diter .env avec vos identifiants
```

### Utilisation

```bash
# Lancer le menu interactif
python3 scapin.py

# Ou commandes CLI directes
python3 scapin.py health      # VÃ©rification santÃ© systÃ¨me
python3 scapin.py process     # Traiter les emails
python3 scapin.py review      # RÃ©viser les dÃ©cisions en attente
```

---

## ğŸ“š Documentation

### Documents Fondateurs

| Document | Description |
|----------|-------------|
| **[DESIGN_PHILOSOPHY.md](docs/DESIGN_PHILOSOPHY.md)** | ğŸ¯ **Document fondateur** â€” Principes philosophiques, fondements thÃ©oriques (Extended Mind, Stiegler, Wegner), vision du partenariat cognitif |
| **[ARCHITECTURE.md](ARCHITECTURE.md)** | Architecture cognitive complÃ¨te â€” Comment l'Ã©quipe des valets fonctionne |
| **[ROADMAP.md](ROADMAP.md)** | Phases de dÃ©veloppement, prioritÃ©s, calendrier (Q1-Q4 2026) |

### Documents Techniques

| Document | Description |
|----------|-------------|
| **[CLAUDE.md](CLAUDE.md)** | Contexte de session pour Claude Code â€” Ã‰tat actuel du projet |
| **[MIGRATION.md](MIGRATION.md)** | Migration depuis PKM System vers Scapin |
| **[BREAKING_CHANGES.md](BREAKING_CHANGES.md)** | Changements d'API et guides de migration |
| **[docs/api/](docs/api/)** | Documentation de rÃ©fÃ©rence API |

### Concepts ClÃ©s

- **Architecture Valet** : Comment Trivelin, Sancho, Passepartout collaborent
- **Raisonnement Multi-Passes** : Pourquoi 10-20s pour de meilleures dÃ©cisions
- **Boucle Cognitive** : Ã‰vÃ©nement â†’ Perception â†’ Raisonnement â†’ Planification â†’ Action â†’ Apprentissage
- **Pharmacologie** : Comment Scapin augmente vos capacitÃ©s sans les remplacer
- **Information en Couches** : Niveau 1 (30s) â†’ Niveau 2 (2min) â†’ Niveau 3 (complet)

---

## ğŸ›£ï¸ Feuille de Route

### Phases ComplÃ©tÃ©es âœ…

| Phase | Nom | Statut |
|-------|-----|--------|
| **0** | Fondations | âœ… Structure, config, logging, CLI |
| **1** | Intelligence Email | âœ… Multi-comptes, classification IA, rÃ©cupÃ©ration erreurs |
| **2** | ExpÃ©rience Interactive | âœ… Menu, file rÃ©vision, UI multi-comptes |
| **0.5** | Architecture Cognitive | âœ… Tous les modules valets implÃ©mentÃ©s |
| **0.6** | Refactoring Valet | âœ… Migration src/ai/ â†’ sancho, src/cli/ â†’ jeeves, email_processor â†’ trivelin |

### Phases en Cours et PlanifiÃ©es ğŸ“…

| Phase | Nom | PÃ©riode | Focus |
|-------|-----|---------|-------|
| **1.0** | Trivelin Email | Q1 2026 | ğŸ—ï¸ Traitement email intelligent multi-passes |
| **1.1** | Journaling Email | Q1 2026 | Feedback loop, prÃ©-remplissage journal |
| **1.2** | IntÃ©gration Teams | Q2 2026 | Messages, rÃ©ponses, appels |
| **1.3** | IntÃ©gration Calendrier | Q2 2026 | Ã‰vÃ©nements, disponibilitÃ©s |
| **1.4** | SystÃ¨me de Briefing | Q2 2026 | Briefing matin, prÃ©-rÃ©union |
| **0.7** | API Jeeves | Q3 2026 | FastAPI REST + WebSockets |
| **0.8** | Interface Web | Q3 2026 | SvelteKit + TailwindCSS |
| **0.9** | PWA Mobile | Q4 2026 | Progressive Web App |

---

## ğŸ§ª Tests

```bash
# Tous les tests
pytest tests/ -v

# Par module
pytest tests/unit/ -v
pytest tests/integration/ -v

# Avec couverture
pytest tests/ --cov=src --cov-report=html
```

**Couverture actuelle** : 95%+ (967 tests)

---

## ğŸ¨ Stack Technologique

### Backend

| Composant | Technologie | Usage |
|-----------|-------------|-------|
| **Langage** | Python 3.11+ | Runtime principal |
| **Validation** | Pydantic | Configuration type-safe |
| **CLI** | Typer + Rich | Interface ligne de commande |
| **Tests** | pytest | 967 tests, 95% couverture |
| **Ã‰vÃ©nements** | EventBus custom | Pub/sub thread-safe |

### IA & Intelligence

| Composant | Technologie | Usage |
|-----------|-------------|-------|
| **IA Principale** | Claude (Anthropic) | Raisonnement Sonnet 4.5 |
| **Consensus** | GPT-4o (OpenAI) | Validation Passe 4 |
| **Embeddings** | sentence-transformers | Recherche sÃ©mantique |
| **Vector DB** | FAISS â†’ ChromaDB | SimilaritÃ© rapide |

### Stockage

| Composant | Technologie | Usage |
|-----------|-------------|-------|
| **Notes** | Markdown + YAML | Base de connaissances lisible |
| **Versioning** | Git | Commits auto, historique complet |
| **Ã‰tat** | SQLite | Suivi dÃ©cisions, erreurs |
| **Graphe** | NetworkX | Relations (Phase 5) |

### IntÃ©grations

| Composant | Technologie | Usage |
|-----------|-------------|-------|
| **Email** | IMAP | Traitement multi-comptes |
| **TÃ¢ches** | OmniFocus MCP | CrÃ©ation et gestion |
| **Credentials** | macOS Keychain | Stockage sÃ©curisÃ© |

---

## ğŸ™ Remerciements

### Inspiration LittÃ©raire

Les valets de la comÃ©die classique qui ont inspirÃ© l'architecture :

- **MoliÃ¨re** â€” Scapin, Sganarelle
- **Marivaux** â€” Trivelin
- **Cervantes** â€” Sancho Panza
- **Dumas** â€” Planchet
- **Beaumarchais** â€” Figaro
- **Wodehouse** â€” Jeeves
- **Verne** â€” Passepartout

### Fondements ThÃ©oriques

- **Clark & Chalmers** â€” Extended Mind Thesis
- **Wegner** â€” MÃ©moire Transactive
- **Stiegler** â€” Pharmacologie de la technique
- **Sparrow et al.** â€” Effet Google
- **Tiago Forte** â€” Building a Second Brain
- **SÃ¶nke Ahrens** â€” MÃ©thode Zettelkasten

### Technologies

- **Anthropic** â€” Claude AI
- **OpenAI** â€” GPT-4o
- **sentence-transformers** â€” Embeddings sÃ©mantiques

---

## ğŸ”„ Migration depuis PKM System

| Aspect | PKM System | Scapin |
|--------|-----------|--------|
| **IdentitÃ©** | Processeur email | Gardien cognitif |
| **Modules** | GÃ©nÃ©riques | ThÃ¨me valet |
| **Version** | v3.1.0 (final) | v1.0.0-alpha |
| **DÃ©pÃ´t** | [ArchivÃ©](https://github.com/johanlb/pkm-system) | [Actif](https://github.com/johanlb/scapin) |
| **DonnÃ©es** | âœ… Compatible | âœ… Copier `.env` et `data/` |

Voir **[MIGRATION.md](MIGRATION.md)** pour les dÃ©tails.

---

## ğŸ“ Licence

MIT License â€” Voir fichier LICENSE

---

## ğŸ“ Contact

**Johan Le Bail**  
GitHub : [@johanlb](https://github.com/johanlb)

---

**ğŸ­ Construit avec intelligence et Ã©lÃ©gance â€” Votre Scapin personnel vous attend.**

*"Le valet qui peut tout faire vaut plus que le maÃ®tre qui ne peut rien."* â€” MoliÃ¨re
